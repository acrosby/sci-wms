<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

  <head>
    <title>Sci-wms: A Python WMS service for geospatial gridded data</title>
    {% load static from staticfiles %}
    <link rel="shortcut icon" href="{% static 'common/favicon.ico' %}" />
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <style>
      table { table-layout: fixed; }
      table th, table td { overflow: hidden; }
      hr { margin-top: 10px; margin-bottom: 10px; }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="page-header">
            <h1>sci-wms <small>a Python WMS service for geospatial gridded data</small></h1>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-10">
          <ul class="nav nav-pills">
            <li><a href="{% url 'index' %}"><span class="glyphicon glyphicon-align-justify"></span> datasets</a></li>
            <li><a href="{% url 'documentation' %}"><span style="color: brown" class="glyphicon glyphicon-book"></span> documentation</a></li>
            <li><a href="{% url 'demo' %}"><span style="color: green" class="glyphicon glyphicon-leaf"></span> demo (Leaflet WMS client)</a></li>
            {% if user.is_authenticated %}
            <li><a href="/wms/logout" data-toggle="modal"><span class="glyphicon glyphicon-log-out"></span> logout</a></li>
            <li><a data-toggle="collapse" href="#addDataset" aria-expanded="false" aria-controls="addDataset"><span style="color: green" class="glyphicon glyphicon-plus"></span> add dataset</a></li>
            {% else %}
            <li><a href="#login" data-toggle="modal"><span class="glyphicon glyphicon-log-in"></span> admin</a></li>
            {% endif %}
          </ul>
        </div>
      </div>

      <hr />

      {% if dataset %}
      <h4>{{dataset.name}} <span class="label label-default">{{ dataset.topology_type }}</span></h4>
      <form>
        <table class="table table-bordered" style="margin-top: 10px;">
          <tr>
            <td width="75%"><b>description</b>: {{dataset.description}}</td>
            <td><b>data</b>: <a class="row" href="{{ dataset.uri }}.html"><span class="glyphicon glyphicon-new-window"></span> data</a></td> <!--TODO local file -->
          </tr>
          <tr>
            <td colspan="2"><b>additional dataset attributes</b>: <pre>{{ dataset.json }}</pre></td> <!-- TODO: replace &gt/&lt -->
        </table>
      </form>

      <div class="panel panel-default">
        <div class="panel-body">
          <p><b>NOTE</b>: CF standard_name required for display of variable as WMS LAYER</p>
          <p><span class="label label-success">green</span> indicates available LAYER, <span class="label label-warning">orange</span> indicates missing field</p>
        </div>
      </div>

      <table class="table table-bordered table-hover" style="margin-top: 30px;">
        <thead>
          <tr>
            <th style="width:200px">NetCDF Variable</th>
            <th style="width:400px">CF standard_name</th>
            <th>long_name</th>
            <th>units</th>
          </tr>
        </thead>
        <tbody>
          {% for key,value in dataset.layers.items %}
          {% if value.standard_name and value.style %}
          <tr class=success>
          {% else %}
          <tr class=text-muted>
          {% endif %}
            <td>{{key}}</td>
            {% if not value.standard_name %}
            <td class=warning><i>no CF standard_name</i></td>
            {% else %}
            <td>{{value.standard_name}}</td>
            {% endif %}
            <td>{{value.long_name}}</td>
            {% if not value.units %}
            <td class=warning><i>no units</i></td>
            {% else %}
            <td>{{value.units}}</td>
            {% endif %}
          </tr>
          {% endfor %}       
        </tbody>
      </table>
      {% endif %}
    </div>


    <!-- Modal HTML -->
    <div id="login" class="modal fade">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title">Sci-wms admin login</h4>
          </div>
          <div class="modal-body">
            <form method="post" action="/wms/login" name="loginForm">
              <p><input type="text" class="span3" name="username" id="username" placeholder="username" value=""></p>
              <p><input type="password" class="span3" id="password" name="password" placeholder="password"></p>
              <p><button type="submit" class="btn btn-success">login</button></p>
            </form>
          </div>
        </div>
      </div>
    </div>

  </body>
</html>
